(function(e){function t(t){for(var r,o,i=t[0],u=t[1],l=t[2],d=0,m=[];d<i.length;d++)o=i[d],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&m.push(a[o][0]),a[o]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);s&&s(t);while(m.length)m.shift()();return c.push.apply(c,l||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],r=!0,i=1;i<n.length;i++){var u=n[i];0!==a[u]&&(r=!1)}r&&(c.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},a={app:0},c=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],u=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var s=u;c.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},1501:function(e,t,n){},"257e":function(e,t,n){"use strict";n("8dd4")},"3d6f":function(e,t,n){"use strict";n("ce23")},"50c0":function(e,t,n){},8480:function(e,t,n){"use strict";n("a338")},"8dd4":function(e,t,n){},"9e23":function(e,t,n){"use strict";n("50c0")},a338:function(e,t,n){},aadf:function(e,t,n){},cd49:function(e,t,n){"use strict";n.r(t);n("b0c0"),n("7f17"),n("f3fc");var r=n("6573"),a=n.n(r),c=(n("9f12"),n("7422")),o=n.n(c),i=(n("163d"),n("f440")),u=n.n(i),l=(n("34c0"),n("aff9")),s=n.n(l),d=(n("4af4"),n("44fb")),m=n.n(d),p=(n("0bd6"),n("05c2")),f=n.n(p),h=(n("8ac7"),n("e661")),b=n.n(h),v=(n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("7a23"));function j(e,t){var n=Object(v["resolveComponent"])("router-view");return Object(v["openBlock"])(),Object(v["createBlock"])(n)}n("e948");const O={};O.render=j;var k=O,g=n("6c02"),w={class:"home"},y=Object(v["createTextVNode"])("join channel");function C(e,t,n,r,a,c){var o=Object(v["resolveComponent"])("el-input"),i=Object(v["resolveComponent"])("el-form-item"),u=Object(v["resolveComponent"])("el-button"),l=Object(v["resolveComponent"])("el-form");return Object(v["openBlock"])(),Object(v["createBlock"])("div",w,[Object(v["createVNode"])(l,{inline:!1,model:e.form,class:"form",rules:e.rules},{default:Object(v["withCtx"])((function(){return[Object(v["createVNode"])(i,{label:"Appid",prop:"appid"},{default:Object(v["withCtx"])((function(){return[Object(v["createVNode"])(o,{modelValue:e.form.appid,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.form.appid=t}),placeholder:"Appid"},null,8,["modelValue"])]})),_:1}),Object(v["createVNode"])(i,{label:"Token",prop:"token"},{default:Object(v["withCtx"])((function(){return[Object(v["createVNode"])(o,{modelValue:e.form.token,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.form.token=t}),placeholder:"Token"},null,8,["modelValue"])]})),_:1}),Object(v["createVNode"])(i,{label:"Channel",prop:"channel"},{default:Object(v["withCtx"])((function(){return[Object(v["createVNode"])(o,{modelValue:e.form.channel,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.form.channel=t}),placeholder:"Channel"},null,8,["modelValue"])]})),_:1}),Object(v["createVNode"])(i,null,{default:Object(v["withCtx"])((function(){return[Object(v["createVNode"])(u,{type:"primary",onClick:e.joinChannel},{default:Object(v["withCtx"])((function(){return[y]})),_:1},8,["onClick"])]})),_:1})]})),_:1},8,["model","rules"])])}n("4160"),n("a15b"),n("4ec9"),n("d3b7"),n("25f0"),n("3ca3"),n("159b"),n("ddb0"),n("96cf");var T=n("1da1"),x=n("d4ec"),V=n("bee2"),R=n("e671"),N=n.n(R);n("4d63"),n("ac1f"),n("5319");function E(e){return e instanceof Promise}function _(){return Date.now()}function B(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"hh:mm:ss",n=Math.floor(e/1e3),r=Math.floor(n/60),a={s:n%60,m:r%60,h:Math.floor(r/60)};for(var c in a){var o="00"+a[c];t=t.replace(new RegExp("".concat(c,"+")),o.substr(o.length-2))}return t}var M=n("2909");function S(e){console.error("[Catch Error] ".concat(e))}function P(e,t){var n;try{n=t?e.apply(void 0,Object(M["a"])(t)):e()}catch(r){S(r)}return n}function I(e){return U.apply(this,arguments)}function U(){return U=Object(T["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=P(t),!n||!E(n)){e.next=3;break}return e.abrupt("return",n.catch((function(e){S(e)})));case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)}))),U.apply(this,arguments)}var q=function(){function e(t){Object(x["a"])(this,e),this.mode="rtc",this.codec="vp8",this.appid=t.appid,this.token=t.token,this.channel=t.channel,this.mode=t.mode||this.mode,this.codec=t.codec||this.codec,this.micTrack=null,this.cameraTrack=null,this.joinReady=null,this.micTrackReady=null,this.cameraTrackReady=null,this.remoteUsers=new Map,this.handleSuccess=t.handleSuccess,this.handleError=t.handleError,this.client=N.a.createClient({mode:this.mode,codec:this.codec})}return Object(V["a"])(e,[{key:"joinChannel",value:function(){var e=Object(T["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.joinReady=this.client.join(this.appid,this.channel,this.token),e.next=3,this.createTracks(t);case 3:return this._subscribeRemoteStream(n),e.abrupt("return",this.joinReady);case 5:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"publish",value:function(){var e=Object(T["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.joinReady){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.joinReady;case 4:this.client.publish(t);case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"unpublish",value:function(){var e=Object(T["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.joinReady){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.joinReady;case 4:this.client.unpublish(t);case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"createTracks",value:function(){var e=Object(T["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.micTrackReady=this.createMicTrack(),this.cameraTrackReady=this.createCameraTrack(t),e.next=4,this.micTrackReady;case 4:return e.next=6,this.cameraTrackReady;case 6:return e.abrupt("return",!0);case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"createMicTrack",value:function(){var e=Object(T["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,I(N.a.createMicrophoneAudioTrack);case 2:return this.micTrack=e.sent,this.publish(this.micTrack),e.abrupt("return",this.micTrack);case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"createCameraTrack",value:function(){var e=Object(T["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,I(N.a.createCameraVideoTrack);case 2:return this.cameraTrack=e.sent,this.cameraTrack.play(t),this.publish(this.cameraTrack),e.abrupt("return",this.cameraTrack);case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"closeMicTrack",value:function(){var e,t;this.micTrack&&(this.client.unpublish([this.micTrack]),null===(e=this.micTrack)||void 0===e||e.stop(),null===(t=this.micTrack)||void 0===t||t.close(),this.micTrack=null,this.micTrackReady=null)}},{key:"closeCameraTrack",value:function(){var e,t;this.cameraTrack&&(this.client.unpublish([this.cameraTrack]),null===(e=this.cameraTrack)||void 0===e||e.stop(),null===(t=this.cameraTrack)||void 0===t||t.close(),this.cameraTrack=null,this.cameraTrackReady=null)}},{key:"dispose",value:function(){var e=Object(T["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.closeMicTrack(),this.closeCameraTrack(),this.client.leave(),this.client.remoteUsers.forEach((function(e){var t=document.getElementById(e.uid.toString());t&&t.remove()}));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"_subscribeRemoteStream",value:function(e){var t=this;this.client.on("user-published",function(){var n=Object(T["a"])(regeneratorRuntime.mark((function n(r,a){var c,o,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.remoteUsers.set(r.uid,r),n.next=3,t.client.subscribe(r,a);case 3:"video"===a&&(c=r.videoTrack,o=document.createElement("div"),o.id=r.uid.toString(),e.append(o),c.play(o)),"audio"===a&&(i=r.audioTrack,i.play());case 5:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()),this.client.on("user-unpublished",(function(e,n){if(t.remoteUsers.delete(e.uid),"video"===n){var r=document.getElementById(e.uid.toString());r&&r.remove()}}))}}]),e}(),D=q,A=n("5502"),L=Object(A["a"])({state:{channel:"",micEnabled:!0,cameraEnabled:!0},mutations:{setChannel:function(e,t){e.channel=t},setMicEnabled:function(e,t){e.micEnabled=t},setCameraEnabled:function(e,t){e.cameraEnabled=t}},actions:{},modules:{}}),H=config.agoraDefault,$=Object(v["defineComponent"])({name:"Home",setup:function(){var e=Object(v["reactive"])({appid:H.appid,token:H.token,channel:H.channel}),t={appid:{required:!0,message:"Appid is required",trigger:"blur"},token:{required:!0,message:"Token is required",trigger:"blur"},channel:{required:!0,message:"Channel is required",trigger:"blur"}};L.commit("setChannel",e.channel),Object(v["watch"])((function(){return e.channel}),(function(e){L.commit("setChannel",e)}));var n=function(){var t=new D({appid:e.appid,token:e.token,channel:e.channel,handleSuccess:function(e){window.logger.log("info","join channel success, uid: ".concat(e))},handleError:function(e){window.logger.log("info","join channel failture, err: ".concat(e))}});window.agora=t,Ee.push("channel")};return{form:e,rules:t,joinChannel:n}}});n("3d6f");$.render=C;var J=$,z={class:"one-to-one"},F={ref:"video-container",id:"videoContainer",class:"video-container"},G={ref:"local",id:"local",class:"video-local video-item"};function K(e,t,n,r,a,c){var o=Object(v["resolveComponent"])("Room");return Object(v["openBlock"])(),Object(v["createBlock"])("div",z,[Object(v["createVNode"])(o,{name:e.name,time:0},{default:Object(v["withCtx"])((function(){return[Object(v["createVNode"])("div",F,[Object(v["createVNode"])("div",G,null,512)],512)]})),_:1},8,["name"])])}var Q={class:"room"},W={class:"room-content"};function X(e,t,n,r,a,c){var o=Object(v["resolveComponent"])("room-header"),i=Object(v["resolveComponent"])("room-controls");return Object(v["openBlock"])(),Object(v["createBlock"])("div",Q,[Object(v["createVNode"])(o,{name:e.name,time:e.time},null,8,["name","time"]),Object(v["createVNode"])("div",W,[Object(v["renderSlot"])(e.$slots,"default")]),Object(v["createVNode"])(i)])}n("a9e3");var Y={class:"room-header"},Z={class:"name"},ee={class:"feats"},te={class:"setting feat-item",style:{display:"none"}};function ne(e,t,n,r,a,c){var o=Object(v["resolveComponent"])("Timer"),i=Object(v["resolveComponent"])("icon"),u=Object(v["resolveComponent"])("el-tooltip");return Object(v["openBlock"])(),Object(v["createBlock"])("div",Y,[Object(v["createVNode"])("div",Z,Object(v["toDisplayString"])(e.name),1),Object(v["createVNode"])(o),Object(v["createVNode"])("div",ee,[Object(v["createVNode"])("span",{class:"share feat-item","data-clipboard-text":e.href},[Object(v["createVNode"])(u,{content:"分享频道",placement:"bottom",effect:"light"},{default:Object(v["withCtx"])((function(){return[Object(v["createVNode"])(i,{name:"icon-fenxiang"})]})),_:1})],8,["data-clipboard-text"]),Object(v["createVNode"])("span",te,[Object(v["createVNode"])(u,{content:"打开设置",placement:"bottom",effect:"light"},{default:Object(v["withCtx"])((function(){return[Object(v["createVNode"])(i,{name:"icon-setting"})]})),_:1})]),Object(v["createVNode"])("span",{class:"setting feat-item",onClick:t[1]||(t[1]=function(){return e.exit&&e.exit.apply(e,arguments)})},[Object(v["createVNode"])(u,{content:"退出频道",placement:"bottom",effect:"light"},{default:Object(v["withCtx"])((function(){return[Object(v["createVNode"])(i,{name:"icon-exit"})]})),_:1})])])])}var re=n("b311"),ae=n.n(re);function ce(e,t,n,r,a,c){return Object(v["openBlock"])(),Object(v["createBlock"])("span",null,Object(v["toDisplayString"])(e.time),1)}var oe=Object(v["defineComponent"])({name:"Timer",setup:function(){var e=_(),t=Object(v["ref"])(0),n=Object(v["computed"])((function(){return B(t.value-e)}));return t.value=_(),setInterval((function(){t.value=_()}),1e3),{time:n}}});oe.render=ce;var ie=oe,ue={class:"icon","aria-hidden":"true"};function le(e,t,n,r,a,c){return Object(v["openBlock"])(),Object(v["createBlock"])("svg",ue,[Object(v["createVNode"])("use",{"xlink:href":"#".concat(e.name)},null,8,["xlink:href"])])}var se=Object(v["defineComponent"])({name:"Icon",props:{name:String}});se.render=le;var de=se,me=Object(v["defineComponent"])({name:"room-header",props:{name:String},components:{Timer:ie,Icon:de},setup:function(){var e=window.agora,t=Object(v["ref"])(""),n=null;function r(){null===e||void 0===e||e.dispose(),Ee.back()}function a(){n=new ae.a(".share"),n.on("success",(function(e){window.message.success("频道已复制到剪切板"),e.clearSelection()})),n.on("error",(function(e){window.message.error("复制频道失败"),window.logger.log("error",e)}))}return Object(v["onMounted"])((function(){Object(v["nextTick"])((function(){a(),t.value=location.href}))})),Object(v["onBeforeUnmount"])((function(){var e;null===(e=n)||void 0===e||e.destroy()})),{href:t,clipboard:n,exit:r}}});n("8480");me.render=ne;var pe=me,fe={class:"room-controls"},he={class:"control-item"},be={class:"hack-ban"},ve=Object(v["createVNode"])("span",{class:"icon-des"},"音频",-1),je={class:"control-item"},Oe={class:"hack-ban"},ke=Object(v["createVNode"])("span",{class:"icon-des"},"视频",-1);function ge(e,t,n,r,a,c){var o=Object(v["resolveComponent"])("icon");return Object(v["openBlock"])(),Object(v["createBlock"])("div",fe,[Object(v["createVNode"])("div",he,[Object(v["createVNode"])("span",{class:"icon-wrapper",onClick:t[1]||(t[1]=function(){return e.toogleMic&&e.toogleMic.apply(e,arguments)})},[Object(v["createVNode"])(o,{name:"icon-mic"}),Object(v["withDirectives"])(Object(v["createVNode"])("span",be,null,512),[[v["vShow"],!e.micEnabled]])]),ve]),Object(v["createVNode"])("div",je,[Object(v["createVNode"])("span",{class:"icon-wrapper",onClick:t[2]||(t[2]=function(){return e.toogleCamera&&e.toogleCamera.apply(e,arguments)})},[Object(v["createVNode"])(o,{name:"icon-video"}),Object(v["withDirectives"])(Object(v["createVNode"])("span",Oe,null,512),[[v["vShow"],!e.cameraEnabled]])]),ke])])}var we=Object(v["defineComponent"])({name:"room-controls",components:{Icon:de},setup:function(){var e=window.agora,t=Object(v["computed"])((function(){return L.state.micEnabled})),n=Object(v["computed"])((function(){return L.state.cameraEnabled}));function r(){return a.apply(this,arguments)}function a(){return a=Object(T["a"])(regeneratorRuntime.mark((function t(){var n,r,a,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:if(n=e.micTrack,r=e.micTrackReady,!r){t.next=8;break}return t.next=7,r;case 7:L.commit("setMicEnabled",n._enabled);case 8:a=e.cameraTrack,c=e.cameraTrackReady,c&&L.commit("setCameraEnabled",a._enabled);case 11:case"end":return t.stop()}}),t)}))),a.apply(this,arguments)}function c(){return o.apply(this,arguments)}function o(){return o=Object(T["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.value?null===e||void 0===e||e.closeMicTrack():null===e||void 0===e||e.createMicTrack(),L.commit("setMicEnabled",!t.value);case 2:case"end":return n.stop()}}),n)}))),o.apply(this,arguments)}function i(){return u.apply(this,arguments)}function u(){return u=Object(T["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n.value?null===e||void 0===e||e.closeCameraTrack():(r=document.getElementById("local"),r&&(null===e||void 0===e||e.createCameraTrack(r))),L.commit("setCameraEnabled",!n.value);case 2:case"end":return t.stop()}}),t)}))),u.apply(this,arguments)}return r(),{micEnabled:t,cameraEnabled:n,toogleMic:c,toogleCamera:i}}});n("9e23");we.render=ge;var ye=we,Ce=Object(v["defineComponent"])({name:"room",components:{RoomHeader:pe,RoomControls:ye},props:{name:String,time:Number}});n("ea7a");Ce.render=X;var Te=Ce,xe=Object(v["defineComponent"])({name:"OneToOne",components:{Room:Te},setup:function(){var e=window.agora;return Object(v["onMounted"])((function(){Object(v["nextTick"])((function(){if(e){var t=document.getElementById("local"),n=document.getElementById("videoContainer");e.joinChannel(t,n)}}))})),Object(v["onBeforeUnmount"])((function(){null===e||void 0===e||e.dispose(),window.agora=null})),{name:L.state.channel}}});n("257e");xe.render=K;var Ve=xe,Re=[{path:"/",name:"Home",component:J},{path:"/channel",name:"Channel",component:Ve}],Ne=Object(g["a"])({history:Object(g["b"])(),routes:Re}),Ee=Ne,_e={off:1,error:0,warn:0,info:0,all:0},Be=function(){function e(t){Object(x["a"])(this,e),this.level=t,this.weight=_e[t]}return Object(V["a"])(e,[{key:"log",value:function(e,t){var n=_e[e];if(!(this.weight<n))switch(e){case"error":this._error(t);break;case"warn":this._warn(t);break;default:this._info(t)}}},{key:"_info",value:function(e){console.log("[Logger info] ".concat(e))}},{key:"_warn",value:function(e){console.warn("[Logger warn] ".concat(e))}},{key:"_error",value:function(e){console.error("[Logger error] ".concat(e))}}]),e}(),Me=Object(v["createApp"])(k).use(L).use(Ee);Me.mount("#app"),Me.component(b.a.name,b.a),Me.component(f.a.name,f.a),Me.component(m.a.name,m.a),Me.component(s.a.name,s.a),Me.component(u.a.name,u.a),Me.component(o.a.name,o.a),Me.config.globalProperties.$message=a.a,window.message=a.a;var Se=new Be(config.logLevel);Me.config.globalProperties.$logger=Se,window.logger=Se},ce23:function(e,t,n){},e948:function(e,t,n){"use strict";n("aadf")},ea7a:function(e,t,n){"use strict";n("1501")}});
//# sourceMappingURL=app.59e3ee83.js.map